define(["app/tools/physics","app/tools/gameStatus","app/tools/maths","app/tools/collisions"],function(e,t,n,r){var i=function(e,t,n,r,i,s){this.position={X:e,Y:t},this.radius=n,this.velocity={magnitude:r,angle:null,X:0,Y:6},this.fillColor=i,this.strokeColor=s};return i.prototype=function(){var n=function(){this.velocity.X=e.calculateVelocity(this.velocity.magnitude,"X",this.velocity.angle),this.velocity.Y=e.calculateVelocity(this.velocity.magnitude,"y",this.velocity.angle)},i=function(e,t,n,r){switch(t){case"right":this.position.X=e.boundary.right-(this.radius+n);break;case"left":this.position.X=e.boundary.left+this.radius+n;break;case"top":r?this.position.Y=e.boundary.top+this.radius+n:this.position.Y=e.boundary.top-(this.radius+n);break;case"bottom":this.position.Y=e.boundary.bottom+this.radius+n;break;default:}},s=function(e){switch(e){case"right":case"left":this.velocity.angle=180-this.velocity.angle;break;case"top":case"bottom":this.velocity.angle=360-this.velocity.angle;break;default:}},o=function(){this.boundary={right:this.position.X+this.radius,left:this.position.X-this.radius,top:this.position.Y-this.radius,bottom:this.position.Y+this.radius}},u=function(e){var o={};r.hitRight(this,e.canvas)?(o.hit=!0,o.side="right"):r.hitLeft(this,e.canvas)&&(o.hit=!0,o.side="left"),r.hitBottom(this,e.canvas)?(o.hit=!0,o.side="bottom"):r.hitTop(this,e.canvas)&&(o.hit=!0,o.side="top"),o.hit&&(i.call(this,e.canvas,o.side,1,!0),s.call(this,o.side),n.call(this),o.side==="bottom"&&(e.status=t.GAME_OVER_LOST))},a=function(t){var s={};r.hitTop(this,t.entities.player)&&(s.hit=!0,s.side="top",this.velocity.angle=e.calcuateAngle(t,this)),r.hitLeft(this,t.entities.player)?(s.hit=!0,s.side="left",this.velocity.angle=165):r.hitRight(this,t.entities.player)&&(s.hit=!0,s.side="right",this.velocity.angle=15),s.hit&&(i.call(this,t.entities.player,s.side,1),n.call(this))},f=function(e){e.entities.bricks.length===0&&(e.status=t.GAME_OVER_WON);for(var o=e.entities.bricks.length-1;o>=0;o--){var u=e.entities.bricks[o],a={};r.hitRight(this,u)?(a.hit=!0,a.side="right"):r.hitLeft(this,u)&&(a.hit=!0,a.side="left"),r.hitBottom(this,u)?(a.hit=!0,a.side="bottom"):r.hitTop(this,u)&&(a.hit=!0,a.side="top");if(a.hit){i.call(this,u,a.side,1),s.call(this,a.side),n.call(this),e.entities.bricks.splice(o,1);break}}},l=function(e,t){o.call(this),u.call(this,e),a.call(this,e),f.call(this,e),this.position.X+=this.velocity.X*t,this.position.Y+=this.velocity.Y*t},c=function(e){e.ctx.fillStyle=this.fillColor,e.ctx.strokeStyle=this.strokeColor,e.ctx.beginPath(),e.ctx.arc(this.position.X,this.position.Y,this.radius,0,2*Math.PI,!0),e.ctx.stroke(),e.ctx.fill(),e.ctx.closePath()};return{draw:c,update:l}}(),i});